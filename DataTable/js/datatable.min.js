/**
 * Datatable aplication
 *
 * Created By: Anthony Diaz
 *
 * This application looks to provide a quick and easy manner of gathering an object of data and displaying it in a
 * paginated, sortable and easy to use manner.
 *
 * Requires: jQuery (Uses compatability calls for cases like wordpress)
 */
var dataTable={_columns:[],_currentPage:1,_data:{},_displayData:{},_drawTarget:null,_lastSortedColumn:"",_numPages:0,_rowsPerPage:25,_sortDir:"none",_sorted:{},_sortKey:"",_title:"Data Table",clearAllData:function(){this._columns=[];this._currentPage=1;this._data={};this._displayData={};this._drawTarget=null;this._lastSortedColumn="";this._numPages=0;this._rowsPerPage=25;this._sortDir="none";this._sorted={};this._sortKey="";this._title="Data Table";return!0},init:function(b,e){if("undefined"==typeof b||
"undefined"==typeof e)return!1;this.clearAllData();this._drawTarget=document.getElementById(e);this._data=this._sorted=b._data;this._title=b._title||"Datatable";var c="",a=0,d;for(d in b._columns)c=b._columns[d],"undefined"==typeof b._columnData[c]._display?b._columnData[c]._display=!1:b._columnData[c]._display&&a++,this._columns.push({_name:"undefined"!=typeof b._columnData[c]._name?b._columnData._name:c,_data:b._columnData[c]});for(c=0;5>a&&"undefined"!=typeof this._columns[c];)0==this._columns[c]._data._display&&
(this._columns[c]._data._display=!0,a++),c++;this._numPages=Math.ceil(this._sorted.length/this._rowsPerPage);this.redraw();return!0},redraw:function(b){if("undefined"==typeof b||"number"!=typeof b)b=1;var e=document.createElement("div");e.className="dataTable-container";var c=document.createElement("div");c.className="datatable-overflow-container";var a=document.createElement("div");a.className="dataTable-table";a.appendChild(this.constructHeader());a.appendChild(this.constructPage((b-1)*this._rowsPerPage,
b*this._rowsPerPage));0<jQuery(a).children(".dataTable-hide").length&&(a.innerHTML="");c.appendChild(a);e.appendChild(this.constructControlHeader());e.appendChild(c);e.appendChild(this.constructFooter());this._drawTarget.innerHTML="";this._drawTarget.appendChild(e);return!0},constructControlHeader:function(){var b=document.createElement("div"),e=document.createElement("ul"),c=document.createElement("ul");c.className="dataTable-control-title";c.innerHTML=this._title;e.className="dataTable-togglecolumn-con";
b.className="dataTable-control-container";var a,d,f;for(f in this._columns)d=document.createElement("ul"),d.className="datatable-togglecolumn-container datatable-unselectable",d.id="datatable-togglecolumn-container-"+this._columns[f]._name,a=document.createElement("input"),a.setAttribute("type","checkbox"),a.id="dataTable-togglecolumn-"+this._columns[f]._name,a.className="dataTable-togglecolumn-checkbox",a.onclick=function(a,b){return function(){a.toggleColumn(a._columns[b]._name)}}(this,f),a.checked=
this._columns[f]._data._display,d.appendChild(a),a=document.createElement("label"),a.className="dataTable-togglecolumn-label datatable-unselectable",a.innerHTML=typeof this._columns[f]._display?this._columns[f]._display:this._columns[f]._name,a.setAttribute("for","dataTable-togglecolumn-"+this._columns[f]._name),d.appendChild(a),e.appendChild(d);b.appendChild(c);b.appendChild(e);return b},constructHeader:function(b){var e=document.createElement("ul");e.className="dataTable-header-row";var c=null,
a=!1,d;for(d in this._columns)0!=this._columns[d]._data._display&&(a=!0,c=document.createElement("li"),c.className="dataTable-header-column unselectable dataTable-hoverable",c.innerHTML=typeof this._columns[d]._display?this._columns[d]._display:this._columns[d]._name,c.id="header_"+this._columns[d]._name,"undefined"!=typeof this._columns[d]._data._sortable&&1==this._columns[d]._data._sortable&&(c.onclick=function(a,b,c){return function(){a.sortColumn(b,c)}}(this,this._columns[d]._name,"header_"+this._columns[d]._name),
c.className+=" dataTable-sortable",this._columns[d]._name==this._sortKey&&(c.className=c.className+" dataTable-sorted-"+this._sortDir)),e.appendChild(c));a||(e.className+=" dataTable-hide");return"undefined"!=typeof b&&b?e.innerHTML:e},constructPage:function(b,e,c){var a=document.createElement("ul");a.className="dataTable-body";a.id="dataTable-body";for(var d,f=b;f<e;f++){b=document.createElement("ul");b.className="dataTable-body-row";b.id="dataTable-body-row-"+f;if("undefined"==typeof this._sorted[f])break;
for(var g in this._columns)if(0!=this._columns[g]._data._display){d=document.createElement("li");d.className="dataTable-body-column";d.id="dataTable-body-row-"+f+"-column-"+this._columns[g]._name;d.innerHTML=this._sorted[f][this._columns[g]._name]._content;"undefined"!=typeof this._sorted[f][this._columns[g]._name]._onClick&&(d.setAttribute("onClick",this._sorted[f][this._columns[g]._name]._onClick),d.className+=" dataTable-clickable");if("undefined"!=typeof this._sorted[f][this._columns[g]._name]._classes)for(var h in this._sorted[f][this._columns[g]._name]._classes)d.className=
d.className+" "+this._sorted[f][this._columns[g]._name]._classes[h];b.appendChild(d)}a.appendChild(b)}return"undefined"!=typeof c&&c?a.innerHTML:a},constructFooter:function(b){var e=document.createElement("div");e.className="dataTable-footer-row";var c,a;c=document.createElement("ul");c.className="dataTable-footer-rows-container";a=document.createElement("li");a.innerHTML="Rows per page:";c.appendChild(a);d=document.createElement("select");d.id="datatable-footer-rows-input";d.onclick=function(a){return function(){a.doUpdateRowsPerPage()}}(this);
d.onkeyup=function(a){return function(){a.doUpdateRowsPerPage()}}(this);a=document.createElement("option");a.innerHTML="25";a.value="25";d.appendChild(a);a=document.createElement("option");a.innerHTML="50";a.value="50";d.appendChild(a);a=document.createElement("option");a.innerHTML="100";a.value="100";d.appendChild(a);d.value=this._rowsPerPage.toString();c.appendChild(d);e.appendChild(c);c=document.createElement("ul");c.className="dataTable-footer-page-container";a=document.createElement("li");a.innerHTML=
"Page:";c.appendChild(a);var d=document.createElement("input");d.id="datatable-footer-page-input";d.setAttribute("type","number");d.setAttribute("min","1");d.setAttribute("max",this._numPages);d.title="This can be typed into or, on browsers that support it, feel free to use the arrows";d.value=this._currentPage;d.onclick=function(a){return function(){a.doChangePage()}}(this);d.onkeyup=function(a){return function(){a.doChangePage()}}(this);c.appendChild(d);a=document.createElement("li");a.innerHTML=
"of "+this._numPages;c.appendChild(a);e.appendChild(c);return"undefined"!=typeof b&&b?e.innerHTML:e},sortColumn:function(b,e,c){var a=document.getElementById(e),d=document.getElementById("dataTable-body");c=c||!1;if(null==a)return!1;if(""!=this._lastSortedColumn&&e!=this._lastSortedColumn){var f=document.getElementById(this._lastSortedColumn);f.className=f.className.replace(/ dataTable-sorted-[\w]+/,"")}if(1==c)return f.className=f.className.replace(/ dataTable-sorted-[\w]+/,""),this._sorted=this._data,
d.innerHTML=this.constructPage(this._rowsPerPage*(this._currentPage-1),this._rowsPerPage*this._currentPage,!0),!0;this._lastSortedColumn=e;this._sortKey=b;~a.className.indexOf("dataTable-sorted-desc")?(a.className=a.className.replace("dataTable-sorted-desc","dataTable-sorted-asc"),this.doSort(b,"asc"),this._sortDir="asc"):~a.className.indexOf("dataTable-sorted-")?(a.className=a.className.replace("dataTable-sorted-asc","dataTable-sorted-desc"),this.doSort(b,"desc"),this._sortDir="desc"):(a.className+=
" dataTable-sorted-asc",this.doSort(b,"asc"),this._sortDir="asc");d.innerHTML=this.constructPage(this._rowsPerPage*(this._currentPage-1),this._rowsPerPage*this._currentPage,!0);return!0},doSort:function(b,e){var c=[],a;for(a in this._columns)if(this._columns[a]._name==b)break;for(var d in this._data)c.push([d,null!==this._data[d][b]._content?this._data[d][b]._content:""]);typeof("undefined"!=this._columns[a]._data._sortType)&&"number"==this._columns[a]._data._sortType?c.sort(this.sortByNumber):typeof("undefined"!=
this._columns[a]._data._sortType)&&"date"==this._columns[a]._data._sortType?c.sort(this.sortByDate):c.sort(this.sort);"undefined"!=typeof e&&"desc"==e&&c.reverse();a=[];for(d in c)a.push(this._data[c[d][0]]);this._sorted=a;return!0},sort:function(b,e){var c=/[^a-zA-Z.\\\/]/g,a=/[^0-9]/g,d=parseInt(b[1],10),f=parseInt(e[1],10);return isNaN(d)&&isNaN(f)?(d=b[1].replace(c,"").toLowerCase(),c=e[1].replace(c,"").toLowerCase(),d===c?(c=parseInt(b[1].replace(a,""),10),a=parseInt(e[1].replace(a,""),10),c===
a?0:c>a?1:-1):d>c?1:-1):isNaN(d)?1:isNaN(f)?-1:d>f?1:-1},sortByNumber:function(b,e){var c=Number(b[1].replace(",","")),a=Number(e[1].replace(",",""));return c<a?-1:c>a?1:0},sortByDate:function(b,e){var c,a;a=c=null;~b.indexOf("/")?(b=b.split("/"),c={day:b[1],month:b[0],year:b[2]}):~b.indexOf("-")&&(b=b.split("-"),c={day:b[0],month:b[1],year:b[2]});~e.indexOf("/")?(e=e.split("/"),a={day:e[1],month:e[0],year:e[2]}):~e.indexOf("-")&&(e=e.split("-"),a={day:e[0],month:e[1],year:e[2]});c="object"==typeof c?
(new Date(c.day+"/"+c.month+"/"+c.year)).getTime():b;a="object"==typeof a?(new Date(a.day+"/"+a.month+"/"+a.year)).getTime():e;return c<a?-1:c>a?1:0},changePage:function(b){if(0<b&&b<=this._numPages){var e=document.getElementById("dataTable-body");this._currentPage=b;e.innerHTML=this.constructPage(this._rowsPerPage*(this._currentPage-1),this._rowsPerPage*this._currentPage,!0);return!0}return!1},doChangePage:function(){var b=document.getElementById("datatable-footer-page-input").value;return-1==b.search(/[a-zA-z]/)&&
b!=this._currentPage?this.changePage(b):!1},doUpdateRowsPerPage:function(){var b=document.getElementById("datatable-footer-rows-input").value;return-1==b.search(/[a-zA-z]/)&&b!=this._rowsPerPage?(this._rowsPerPage=b,this._currentPage=1,this._numPages=Math.ceil(this._sorted.length/this._rowsPerPage),this.redraw(this._currentPage),!0):!1},doUpdateCurrentData:function(b){return"undefined"!=typeof b?(this._data=b,""!=this._sortKey?"desc"==this._sortDir?this.doSort(this._sortKey,"desc"):this.doSort(this._sortKey,
"asc"):this._sorted=this._data,this._numPages=Math.ceil(this._sorted.length/this._rowsPerPage),this._currentPage=1!=this._currentPage&&0>this._currentPage?this._currentPage<=this._numPages?this._currentPage:this._numPages:1,this.redraw(this._currentPage),!0):!1},toggleColumn:function(b){if("undefined"!=typeof b){for(var e in this._columns)this._columns[e]._name==b&&(this._columns[e]._data._display=!this._columns[e]._data._display);b=jQuery(".dataTable-table");b.html("");b.append(this.constructHeader());
b.append(this.constructPage(this._rowsPerPage*(this._currentPage-1),this._rowsPerPage*this._currentPage));return!0}return!1}};
//# sourceMappingURL=/js/datatable.min.js.map